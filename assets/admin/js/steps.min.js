function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module&&"function"==typeof require?module.exports=e(require("jquery")):e(t.jQuery)}(this,(function(t){"use strict";var e="wcpwSteps",n={},a=t(document),s=function(e,a){return this.element=e,this.options=t.extend({},n,a),this.init()};s.prototype.init=function(){return this.$element=t(this.element),this.$list=this.$element.find('[data-component~="wcpw-steps-list"]'),this.$modal=t('[data-component~="wcpw-step-modal"]'),this.$modalBody=this.$modal.find('[data-component~="wcpw-step-modal-body"]'),this.ajaxURL=this.element.getAttribute("data-ajax-url"),t.fn.sortable&&this.$list.sortable({items:'[data-component~="wcpw-steps-list-item"]',distance:50}),this},s.prototype.addItem=function(){var t=this.$list.children(),e=0;t.length&&t.each((function(){e=Math.max(e,Number(this.getAttribute("data-id")))})),e++;var n=this.$element.find('[data-component~="wcpw-steps-list-item-template"]').clone().appendTo(this.$list).attr("data-component","wcpw-steps-list-item").attr("data-id",e),a=n.find('[data-component~="wcpw-steps-list-item-settings"]'),s=n.find('[data-component~="wcpw-steps-list-item-clone"]');return n.find('[data-component~="wcpw-steps-list-item-name"]').text("#".concat(e)).end().find('[data-component~="wcpw-steps-list-item-id"]').attr("name","_steps_ids[".concat(e,"]")).attr("value",e),a.attr("data-settings",a.attr("data-settings").replace(/%STEP_ID%/g,e)),s.attr("data-settings",s.attr("data-settings").replace(/%STEP_ID%/g,e)),this.$element.trigger("added.item.steps.wcpw",[this,s]),n},s.prototype.showModal=function(){return this.$modal.addClass("is-opened"),this},s.prototype.hideModal=function(){return this.$modal.removeClass("is-opened"),this},s.prototype.getSettings=function(e){var n=this,a=t.extend({action:"wcpwGetStepSettingsForm",_wcpw_nonce:window._wcpw_nonce.value},e);return t.get(this.ajaxURL,a,(function(t){n.$modalBody.html(t),n.showModal(),n.$element.trigger("get.settings.item.steps.wcpw",[n,t])}))},s.prototype.saveSettings=function(e){var n=e.find("#title").val(),a=e.find("#notes").val(),s=e.attr("data-step-id"),i={action:"wcpwSaveStepSettings",post_id:e.attr("data-post-id"),step_id:s,values:e.serialize(),_wcpw_nonce:window._wcpw_nonce.value};return this.$list.find('[data-component="wcpw-steps-list-item"][data-id="'.concat(s,'"] ')+'[data-component="wcpw-steps-list-item-name"]').html("#".concat(s," ").concat(n)+(a?" <small>(".concat(a,")</small>"):"")),t.post(this.ajaxURL,i,null,"json")},s.prototype.cloneItem=function(e,n,a){var s={action:"wcpwCloneStepSettings",post_id:e,source_step:n,target_step:a,_wcpw_nonce:window._wcpw_nonce.value};return t.post(this.ajaxURL,s,null,"json")},s.prototype.removeItem=function(t){return t.remove(),this.$element.trigger("removed.item.steps.wcpw",[this]),this},s.prototype.checkFromValidity=function(t){var e=!0;return 0===t.length||t.each((function(){"undefined"!==this.checkValidity&&(e=this.checkValidity())})),e},t.fn[e]=function(n){return this.each((function(){t.data(this,e)||t.data(this,e,new s(this,n))}))};var i=function(){return t('[data-component~="wcpw-steps"]').each((function(){return t(this).wcpwSteps()}))};a.ready((function(){return i()})),a.on("init.steps.wcpw",(function(){return i()})),a.on("click",'[data-component~="wcpw-steps-add"]',(function(n){n.preventDefault();var a=t(this).closest('[data-component~="wcpw-steps"]');return a.data(e)?a.data(e).addItem():this})),a.on("click",'[data-component~="wcpw-steps-list-item-remove"]',(function(n){n.preventDefault();var a=t(this),s=a.closest('[data-component~="wcpw-steps"]');return s.data(e)?s.data(e).removeItem(a.closest('[data-component~="wcpw-steps-list-item"]')):this})),a.on("click",'[data-component~="wcpw-steps-list-item-settings"]',(function(n){n.preventDefault();var a=t(this),s=a.closest('[data-component~="wcpw-steps"]');return a.addClass("is-loading"),s.data(e)?s.data(e).getSettings(a.data("settings")).always((function(){return a.removeClass("is-loading")})):this})),a.on("click",'[data-component~="wcpw-steps-list-item-clone"]',(function(n){n.preventDefault();var a=t(this),s=a.closest('[data-component~="wcpw-steps"]');if(a.addClass("is-loading"),s.data(e)){var i=s.data(e).addItem();return s.data(e).cloneItem(a.data("settings").post_id,a.data("settings").step_id,i.data("id")).always((function(){return a.removeClass("is-loading")}))}return this})),a.on("submit",'[data-component~="wcpw-step-settings-form"]',(function(n){var a=t(this),s=t('[data-component~="wcpw-steps"]');if(s.data(e)){if(!s.data(e).checkFromValidity(a))return a.find('[data-component~="wcpw-settings-group-content"]').attr("aria-expanded","true"),this;n.preventDefault();var i=a.find('[data-component~="wcpw-step-settings-form-submit"]');i.addClass("is-loading"),s.data(e).saveSettings(a).always((function(){return i.removeClass("is-loading")}))}return this})),a.on("click",'[data-component~="wcpw-step-modal-close"]',(function(){var n=t('[data-component~="wcpw-steps"]');return n.data(e)&&n.data(e).hideModal(),this})),a.on("change",'[data-component~="wcpw-step-setting-apply-to-all-input"]',(function(){var e=t(this);e.closest('[data-component~="wcpw-step-setting-apply-to-all-label"]')[e.is(":checked")?"addClass":"removeClass"]("is-active")}))}));