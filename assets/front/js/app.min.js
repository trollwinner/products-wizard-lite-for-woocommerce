function _defineProperty(t,e,r){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,_toPropertyKey(a.key),a)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"==_typeof(e)?e:e+""}function _toPrimitive(t,e){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var a=r.call(t,e||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var a=0,n=function(){};return{s:n,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,a=Array(e);r<e;r++)a[r]=t[r];return a}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}!function(t,e){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("src/front/js/app.js",e):((t="undefined"!=typeof globalThis?globalThis:t||self)["src/front/js/app"]=t["src/front/js/app"]||{},t["src/front/js/app"].js=e())}(this,(function(){"use strict";function t(e,r){return Object.keys(e).every((function(a){return!!r.hasOwnProperty(a)&&("object"===_typeof(e[a])?t(e[a],r[a]):e[a]===r[a])}))}function e(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Object.assign.apply(Object,[{}].concat(e))}function r(t,e,a){var n=/^[^\[\]]+\[]/.test(e),i=/^[^\[\]]+\[[^\[\]]+]/.test(e),o=e.replace(/\[.*/,"");if(n)t[o]||(t[o]=[]);else{if(!i)return t.push?t.push(a):t[o]=a,null;t[o]||(t[o]={})}var s=e.match(/\[[^\[\]]*]/g);return s[0]=s[0].replace(/\[|]/g,""),r(t[o],s.join(""),a)}function a(t){var e={};if(!t)return e;var a=t.split("&");for(var n in a)a[n].includes("=")||(a[n]="".concat(a[n],"="));t=a.join("&");var i=JSON.parse('{"'+decodeURI(t).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}');for(var o in i)i.hasOwnProperty(o)&&r(e,o,i[o]);return e}function n(t,e){t.textContent="",t.insertAdjacentHTML("afterbegin",e)}function i(t){return"object"===_typeof(t)?t:JSON.parse(t||"{}")}var o=function(){return _createClass((function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t);var a={jQueryCompatibility:!0,ajaxURL:"/wp-admin/admin-ajax.php",nonce:"",documentNode:document,windowNode:window,rootSelector:"html, body",ajaxActions:{submit:"wcpwSubmit",addToMainCart:"wcpwAddToMainCart",getStep:"wcpwGetStep",getStepPage:"wcpwGetStepPage",skipStep:"wcpwSkipStep",skipAll:"wcpwSkipAll",submitAndSkipAll:"wcpwSubmitAndSkipAll",reset:"wcpwReset",addCartProduct:"wcpwAddCartProduct",removeCartProduct:"wcpwRemoveCartProduct",updateCartProduct:"wcpwUpdateCartProduct"}};this.element=e,this.$element=null,this.customOptions=r,this.options=Object.assign({},a,r)}),[{key:"init",value:function(){return this.options.jQueryCompatibility&&"undefined"!=typeof jQuery&&(this.$element=jQuery(this.element),this.$element.data("wcpw",this)),this.hasError=!1,this.preventAjaxRequest=!1,this.productsWithError=[],this.ajaxRequestsQueue=[],this.eventListeners=[],this.initEventListeners().triggerEvent("launched.wcpw")}},{key:"ajaxRequest",value:function(t){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.preventAjaxRequest=!1;var i,o=t instanceof FormData?t:new FormData,s={element:this.element,contentMethod:"setHTML",updateQueryArgs:!0,queryArgs:{},passCurrentQueryArgs:!0,currentQueryArgs:this.getQueryArgs(),method:"post",scrollingTopOnUpdate:(i=this.options.scrollingTopOnUpdate,Boolean(JSON.parse(String(i)))),scrollingGap:Number(this.options.hasOwnProperty("scrollingUpGap")?this.options.scrollingUpGap:0),scrollingBehavior:"smooth",scrollingToElement:null,passProducts:!1,errorsAlerting:!0,errorsLogging:!0,lazy:!1};if((a=e(s,a)).passCurrentQueryArgs&&a.currentQueryArgs.get&&(a.currentQueryArgs.has("wcpwPage")&&o.append("wcpwPage",a.currentQueryArgs.get("wcpwPage")),a.currentQueryArgs.has("wcpwOrderBy")&&o.append("wcpwOrderBy",a.currentQueryArgs.get("wcpwOrderBy"))),!(t instanceof FormData))for(var c in t)t.hasOwnProperty(c)&&null!==t[c]&&o.append(c,"string"!=typeof t[c]?JSON.stringify(t[c]):t[c]);for(var u in a.passProducts||(o.delete("productsToAdd"),o.delete("productsToAddChecked")),this.customOptions)!o.has(u)&&this.customOptions.hasOwnProperty(u)&&o.append(u,"string"!=typeof this.customOptions[u]?JSON.stringify(this.customOptions[u]):this.customOptions[u]);if(o.delete("add-to-cart"),o.append("nonce",this.options.nonce),this.triggerEvent("ajaxRequest.wcpw",{formData:o,options:a}),this.preventAjaxRequest)return this.triggerEvent("ajaxPrevent.wcpw",{formData:o,options:a}),Promise.resolve();a.element.classList.add(a.lazy?"is-lazy-loading":"is-loading"),a.element.setAttribute("aria-live","polite"),a.element.setAttribute("aria-busy","true");var l=new Promise((function(t,e){var n=new XMLHttpRequest;n.open(a.method.toUpperCase(),r.options.ajaxURL,!0),n.addEventListener("progress",(function(t){t.lengthComputable&&a.element.style.setProperty("--wcpw-loading-progress",String(Math.round(t.loaded/t.total*100)))})),n.onload=function(){n.status>=200&&n.status<300?t(n.response):e(n.status)},n.onerror=function(){return e(n.status)},n.send(o)})).then((function(t){try{if("string"==typeof t&&(t=JSON.parse(t)),"object"!==_typeof(t))throw new Error("Response parsing error")}catch(t){return Promise.reject(t)}r.triggerEvent("ajaxSuccess.wcpw",{response:t,formData:o,options:a});var i=r.ajaxRequestsQueue.indexOf(l);if(i>-1&&r.ajaxRequestsQueue.splice(i,1),a.lazy&&r.ajaxRequestsQueue.length>0)return t;if(a.element.classList.remove("is-lazy-loading","is-loading"),a.element.setAttribute("aria-busy","false"),a.element.style.removeProperty("--wcpw-loading-progress"),t.content)if("replaceHTML"===a.contentMethod)!function(t,e){var r=document.createElement("div");n(r,e),t.replaceWith.apply(t,_toConsumableArray(r.childNodes)),r.remove()}(a.element,t.content);else n(a.element,t.content);var s,c=_createForOfIteratorHelper(a.element.querySelectorAll('[data-component~="wcpw-nav"]'));try{for(c.s();!(s=c.n()).done;){var u=s.value,d=u.querySelector('[data-component~="wcpw-nav-list"]');if(d)u.querySelector(".active")&&(d.scrollLeft=u.querySelector(".active").offsetLeft)}}catch(t){c.e(t)}finally{c.f()}if(a.scrollingTopOnUpdate){var p=a.element.querySelector(a.scrollingToElement||'[data-component~="wcpw-form-step"].is-active');p&&!r.isScrolledIntoView(p)&&r.scrollToElement(p,Number(a.scrollingGap),a.scrollingBehavior)}return a.updateQueryArgs&&(t instanceof Object&&t.hasOwnProperty("stateData")&&(a.queryArgs=e(a.queryArgs,t.stateData)),0!==Object.keys(a.queryArgs).filter((function(t){return!1!==a.queryArgs[t]})).length&&r.setQueryArgs(a.queryArgs)),r.triggerEvent("ajaxCompleted.wcpw",{response:t,formData:o,options:a}),t})).catch((function(t){r.triggerEvent("ajaxError.wcpw",{error:t,formData:o,options:a});var e=r.ajaxRequestsQueue.indexOf(l);return e>-1&&r.ajaxRequestsQueue.splice(e,1),a.classList.remove("is-lazy-loading","is-loading"),a.setAttribute("aria-busy","false"),a.style.removeProperty("--wcpw-loading-progress"),a.errorsLogging&&r.options.windowNode.console.error(t),a.errorsAlerting&&r.options.windowNode.alert("Unexpected error occurred: ".concat(t)),t}));return this.ajaxRequestsQueue.push(l),l}},{key:"delegateEventListener",value:function(t,e,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{capture:!1},n=t.split(".")[0],i=function(t){for(var a=t.target;a&&!a.matches(e)&&a!==this;)a=a.parentElement;return a&&a.matches(e)&&r.call(a,t),this};return this.eventListeners.push({action:t,actionName:n,selector:e,handler:i}),this.element.addEventListener(n,i,a),this}},{key:"unDelegateEventListener",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{capture:!1},a=this.eventListeners.filter((function(r){return r.action===t&&(!e||r.selector===e)}));return a[0]&&this.element.removeEventListener(a[0].actionName,a[0].handler,r),this}},{key:"initEventListeners",value:function(){var t=this,e=this;return this.options.windowNode.addEventListener("popstate",(function(e){return t.popState(e)}),!1),this.delegateEventListener("click.thumbnail.product.wcpw",'[data-component~="wcpw-product-thumbnail-link"]',(function(t){return t.preventDefault()})),this.delegateEventListener("click.product.wcpw",'[data-component~="wcpw-product"]',(function(){var t=this.querySelector('[data-component~="wcpw-product-choose"][type="radio"]');!t||t.checked||t.disabled||(t.checked=!0,t.dispatchEvent(new Event("change")))})),this.delegateEventListener("click.add.product.cart.wcpw",'[data-component~="wcpw-add-cart-product"]',(function(t){var r=this;if(this.classList.contains("disabled"))return t.preventDefault();var a,n=[],o=this.closest('[data-component~="wcpw-product"]'),s=_createForOfIteratorHelper(e.element.querySelectorAll("input:not(:disabled),select:not(:disabled),textarea:not(:disabled)"));try{for(s.s();!(a=s.n()).done;){var c=a.value;o.contains(c)||n.push(c)}}catch(t){s.e(t)}finally{s.f()}if(!e.options.documentNode.querySelector("#"+this.getAttribute("form")).checkValidity()){var u,l=_createForOfIteratorHelper(n);try{for(l.s();!(u=l.n()).done;){u.value.disabled=!1}}catch(t){l.e(t)}finally{l.f()}return this}for(var d=0,p=n;d<p.length;d++){p[d].disabled=!1}return this.classList.add("is-loading"),this.setAttribute("aria-busy","true"),t.preventDefault(),e.addCartProduct({productToAddKey:this.value},i(this.getAttribute("data-add-cart-product-options"))).finally((function(){r.classList.remove("is-loading"),r.setAttribute("aria-busy","false")}))})),this.delegateEventListener("click.update.product.cart.wcpw",'[data-component~="wcpw-update-cart-product"]',(function(t){var r=this;if(this.classList.contains("disabled"))return t.preventDefault();var a,n=[],o=this.closest('[data-component~="wcpw-product"]'),s=_createForOfIteratorHelper(e.element.querySelectorAll("input:not(:disabled),select:not(:disabled),textarea:not(:disabled)"));try{for(s.s();!(a=s.n()).done;){var c=a.value;o.contains(c)||n.push(c)}}catch(t){s.e(t)}finally{s.f()}for(var u=0,l=n;u<l.length;u++){l[u].disabled=!0}for(var d=0,p=n;d<p.length;d++){p[d].disabled=!0}if(!e.options.documentNode.querySelector("#"+this.getAttribute("form")).checkValidity()){var h,v=_createForOfIteratorHelper(n);try{for(v.s();!(h=v.n()).done;){h.value.disabled=!1}}catch(t){v.e(t)}finally{v.f()}return this}for(var f=0,g=n;f<g.length;f++){g[f].disabled=!1}return this.classList.add("is-loading"),this.setAttribute("aria-busy","true"),t.preventDefault(),e.updateCartProduct({productCartKey:this.value},i(this.getAttribute("data-update-cart-product-options"))).finally((function(){r.classList.remove("is-loading"),r.setAttribute("aria-busy","false")}))})),this.delegateEventListener("click.remove.product.cart.wcpw",'[data-component~="wcpw-remove-cart-product"]',(function(t){var r=this;return t.preventDefault(),this.classList.add("is-loading"),this.setAttribute("aria-busy","true"),e.removeCartProduct({productCartKey:this.value},i(this.getAttribute("data-remove-cart-product-options"))).finally((function(){r.classList.remove("is-loading"),r.setAttribute("aria-busy","false")}))})),this.delegateEventListener("click.nav.wcpw",'[data-component~="wcpw-nav-item"]',(function(t){var r=this.getAttribute("data-nav-action"),a={action:r};return e.options.documentNode.querySelector("#"+this.getAttribute("form")).checkValidity()||-1===["submit","add-to-main-cart","add-to-main-cart-repeat"].indexOf(r)?(t.preventDefault(),this.getAttribute("data-nav-id")&&(a.stepId=this.getAttribute("data-nav-id")),e.navRouter(a)):this})),this.delegateEventListener("click.pagination.wcpw",'[data-component~="wcpw-form-pagination-link"]',(function(t){t.preventDefault();var r=e.getQueryArgs(),n=this.getAttribute("data-step-id"),i=this.getAttribute("data-page"),o={};r.get&&r.has("wcpwPage")&&r.get("wcpwPage")&&(o=a(r.get("wcpwPage"))),o[n]=i;var s,c,u,l=(s=[],c=function(t,e){e=null==(e="function"==typeof e?e():e)?"":e,s[s.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)},(u=function(t,e){var r,a,n;if(t)if(Array.isArray(e))for(r=0,a=e.length;r<a;r++)u(t+"["+("object"===_typeof(e[r])&&e[r]?r:"")+"]",e[r]);else if("[object Object]"===Object.prototype.toString.call(e))for(n in e)u(t+"["+n+"]",e[n]);else c(t,e);else if(Array.isArray(e))for(r=0,a=e.length;r<a;r++)c(e[r].name,e[r].value);else for(n in e)u(n,e[n]);return s})("",o).join("&"));return e.getStepPage({stepId:n,page:i,wcpwPage:l},{element:this.closest('[data-component="wcpw-form-step"]'),contentMethod:"replaceHTML",queryArgs:{wcpwPage:l},scrollingTopOnUpdate:!0,scrollingToElement:'[data-component~="wcpw-form-step"][data-id="'.concat(n,'"]')})})),this.delegateEventListener("click.toggle.wcpw",'[data-component~="wcpw-toggle"]',(function(t){t.preventDefault();var r=this.getAttribute("data-toggle-target")||this.getAttribute("href"),a=e.element.querySelector(r),n="false"===a.getAttribute("aria-expanded");this.setAttribute("aria-expanded",n?"true":"false"),a.setAttribute("aria-expanded",n?"true":"false"),e.options.documentNode.cookie="".concat(r,"-expanded=").concat(String(n),"; path=/"),e.triggerEvent("toggle.wcpw",{element:this,target:a})})),this.delegateEventListener("click.scrollToElement.wcpw",'[data-component~="wcpw-scroll-to-element"]',(function(t){t.preventDefault();var r=this.getAttribute("data-scroll-to-element-target")||this.getAttribute("href"),a=e.element.querySelector(r);a&&!e.isScrolledIntoView(a)&&(e.scrollToElement(a),e.triggerEvent("scrollToElement.wcpw",{element:this,target:a}))})),this}},{key:"triggerEvent",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.$element&&this.$element.trigger(t,Object.values(e(r))),this.element.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e({instance:this},r)})),this}},{key:"popState",value:function(t){var e={action:this.options.ajaxActions.getStep},r=t&&t.state&&t.state.path;if(!r)return Promise.resolve();var n=new URL(r).searchParams;return n.has("wcpwStep")&&(e.stepId=n.get("wcpwStep")),n.has("wcpwPages")&&(e.page=a(n.get("wcpwPages"))[e.stepId]),n.has("wcpwOrderBy")&&(e.orderby=a(n.get("wcpwOrderBy"))[e.stepId]),this.ajaxRequest(e,{updateQueryArgs:!1})}},{key:"addCartProduct",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch((r=e({behavior:"default",passProducts:!0},r)).behavior){default:case"default":return this.submit(e({action:this.options.ajaxActions.addCartProduct},t),e({scrollingTopOnUpdate:!1},r));case"submit":return this.submit(t,r);case"add-to-main-cart":return this.addToMainCart(t,r)}}},{key:"updateCartProduct",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch((r=e({behavior:"default",passProducts:!0},r)).behavior){default:case"default":return this.submit(e({action:this.options.ajaxActions.updateCartProduct},t),e({scrollingTopOnUpdate:!1},r));case"submit":return this.submit(t,r);case"add-to-main-cart":return this.addToMainCart(t,r)}}},{key:"removeCartProduct",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=e({action:this.options.ajaxActions.removeCartProduct},t),r=e({scrollingTopOnUpdate:!1,passProducts:!0},r),this.ajaxRequest(t,r)}},{key:"addToMainCart",value:function(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r=e({action:this.options.ajaxActions.addToMainCart},r),a=e({preventRedirect:!1,passProducts:!0},a);var n=this.submit(r,a);return this.triggerEvent("addToMainCart.wcpw",{data:r,result:n}),n?n.then((function(e){return e instanceof Object&&e.hasError||t.hasError?(t.triggerEvent("addToMainCartError.wcpw",{data:r,response:e}),e):(!a.preventRedirect&&e instanceof Object&&!e.preventRedirect&&e.hasOwnProperty("finalRedirectURL")&&e.finalRedirectURL&&(t.triggerEvent("addToMainCartRedirect.wcpw",{data:r,response:e}),t.options.documentNode.location=e.finalRedirectURL),e)})):Promise.resolve()}},{key:"submit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.hasError=!1,this.productsWithError=[];var n=function(t){var e,a={},n=_createForOfIteratorHelper(new FormData(t).entries());try{for(n.s();!(e=n.n()).done;){var i=e.value;r(a,i[0],i[1])}}catch(t){n.e(t)}finally{n.f()}return a}(this.element.querySelector('[data-component~="wcpw-form"]')||this.options.documentNode.querySelector('[data-component~="wcpw-form"]'));if(t=e({action:this.options.ajaxActions.submit,productToAddKey:null,productsToAdd:[],productsToAddChecked:[]},t,n),a=e({passProducts:!0},a),t.productToAddKey){for(var i in t.productsToAdd)if(t.productsToAdd.hasOwnProperty(i)){var o=t.productsToAdd[i];"".concat(o.step_id,"-").concat(o.product_id)!==t.productToAddKey?delete t.productsToAdd[i]:t.productsToAddChecked=_defineProperty({},o.step_id,[o.product_id])}}else delete t.productToAddKey;return this.triggerEvent("submit.wcpw",{data:t}),this.hasError?(this.triggerEvent("submitError.wcpw",{data:t}),Promise.resolve()):this.ajaxRequest(t,a)}},{key:"navRouter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.action;switch(delete t.action,r){case"skip-step":return this.skipStep(t,e);case"skip-all":return this.skipAll(t,e);case"submit-and-skip-all":return this.submitAndSkipAll(t,e);case"submit":return this.submit(t,e);case"add-to-main-cart":return this.addToMainCart(t,e);case"reset":return this.reset(t,e);case"none":return null;default:return this.getStep(t,e)}}},{key:"skipStep",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=e({action:this.options.ajaxActions.skipStep},t),this.ajaxRequest(t,r)}},{key:"submitAndSkipAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=e({action:this.options.ajaxActions.submitAndSkipAll},t),this.submit(t,r)}},{key:"skipAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=e({action:this.options.ajaxActions.skipAll},t),this.ajaxRequest(t,r)}},{key:"getStep",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=e({action:this.options.ajaxActions.getStep},t),this.ajaxRequest(t,r)}},{key:"getStepPage",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=e({action:this.options.ajaxActions.getStepPage},t),this.ajaxRequest(t,r)}},{key:"reset",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=e({action:this.options.ajaxActions.reset},t),this.ajaxRequest(t,r)}},{key:"getQueryArgs",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.windowNode.location.search;return"undefined"==typeof URLSearchParams?{}:new URLSearchParams(t)}},{key:"setQueryArgs",value:function(t){if(!this.options.windowNode.history||!this.options.windowNode.history.pushState)return this;var e=this.getQueryArgs();if(!e.get)return this;for(var r in t)t.hasOwnProperty(r)&&("boolean"!=typeof t[r]||t[r]?e.set(r,t[r]):e.delete(r));var a=this.options.windowNode.location,n="".concat(a.protocol,"//").concat(a.host).concat(a.pathname,"?").concat(e.toString());return this.options.windowNode.history.pushState({path:n},"",n),this}},{key:"vibrate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[200];return"vibrate"in this.options.windowNode.navigator?this.options.windowNode.navigator.vibrate(t):"oVibrate"in this.options.windowNode.navigator?this.options.windowNode.navigator.oVibrate(t):"mozVibrate"in this.options.windowNode.navigator?this.options.windowNode.navigator.mozVibrate(t):"webkitVibrate"in this.options.windowNode.navigator&&this.options.windowNode.navigator.webkitVibrate(t),this}},{key:"isScrolledIntoView",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=t.getBoundingClientRect();return!e&&r.top>=0&&r.top<=this.options.windowNode.innerHeight||e&&r.top>=0&&r.bottom<=this.options.windowNode.innerHeight}},{key:"scrollToElement",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"smooth",a=!0===this.options.windowNode.matchMedia("(prefers-reduced-motion: reduce)")||!0===this.options.windowNode.matchMedia("(prefers-reduced-motion: reduce)").matches;return this.options.windowNode.scrollTo({top:t.getBoundingClientRect().top+this.options.windowNode.scrollY-Number(e),behavior:a?"instant":r}),this}}])}(),s=function(){return _createClass((function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.element=e,this.$element=null,this.customOptions=r,this.options=Object.assign({},{jQueryCompatibility:!0},r)}),[{key:"init",value:function(){return this.options.jQueryCompatibility&&"undefined"!=typeof jQuery&&(this.$element=jQuery(this.element)),this.eventListeners=[],this.$reset=this.element.querySelectorAll('[data-component~="wcpw-product-variations-reset"]'),this.id=this.element.querySelector('[data-component~="wcpw-product-variations-variation-id"]'),this.$input=this.element.querySelectorAll('[data-component~="wcpw-product-variations-item-input"]'),this.$variationItem=this.element.querySelectorAll('[data-component~="wcpw-product-variations-item"]'),this.$variationItemValue=this.element.querySelectorAll('[data-component~="wcpw-product-variations-item-value"]'),this.product=this.element.closest('[data-component~="wcpw-product"]'),this.$productPrice=this.product.querySelectorAll('[data-component~="wcpw-product-price"]'),this.$productQuantity=this.product.querySelector('[data-component~="wcpw-product-quantity"] input:not([type="button"])'),this.$productDescription=this.product.querySelectorAll('[data-component~="wcpw-product-description"]'),this.$productAvailability=this.product.querySelectorAll('[data-component~="wcpw-product-availability"]'),this.$productSku=this.product.querySelectorAll('[data-component~="wcpw-product-sku"]'),this.$productAddToCart=this.product.querySelectorAll('[data-component~="wcpw-add-cart-product"]'),this.$productChoose=this.product.querySelectorAll('[data-component~="wcpw-product-choose"]'),this.$productImage=this.product.querySelectorAll('[data-component~="wcpw-product-thumbnail-image"]'),this.$productLink=this.product.querySelectorAll('[data-component~="wcpw-product-thumbnail-link"]'),this.initEventListeners().triggerEvent("launched.variationForm.wcpw")}},{key:"delegateEventListener",value:function(t,e,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{capture:!1},n=t.split(".")[0],i=function(t){for(var a=t.target;a&&!a.matches(e)&&a!==this;)a=a.parentElement;return a&&a.matches(e)&&r.call(a,t),this};return this.eventListeners.push({action:t,actionName:n,selector:e,handler:i}),this.element.addEventListener(n,i,a),this}},{key:"unDelegateEventListener",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{capture:!1},a=this.eventListeners.filter((function(r){return r.action===t&&(!e||r.selector===e)}));return a[0]&&this.element.removeEventListener(a[0].actionName,a[0].handler,r),this}},{key:"initEventListeners",value:function(){var r=this,a=this;return this.unDelegateEventListener("change.input.variationForm.wcpw",'[data-component~="wcpw-product-variations-item-input"]'),this.element.addEventListener("check_variations",(function(a){var i,o={},s=!0,c=_createForOfIteratorHelper(r.$input);try{for(c.s();!(i=c.n()).done;){var u=i.value;"SELECT"!==u.tagName||u.value&&0!==u.value.length||(s=!1),("SELECT"===u.tagName||u.checked)&&(o[u.getAttribute("data-name")]=u.value)}}catch(t){c.e(t)}finally{c.f()}var l=r.findMatchingVariations(JSON.parse(r.element.getAttribute("data-product_variations")||"{}"),o);if(s){var d=null;for(var p in l)if(l.hasOwnProperty(p)){var h=e(o),v=e(l[p].attributes);for(var f in v)v.hasOwnProperty(f)&&""===v[f]&&(v[f]=h[f]);if(t(v,h)){d=l[p];break}}d?(r.id.value=d.variation_id,r.triggerEvent("found_variation",{variation:d})):a.detail.focus||(r.triggerEvent("reset_image"),r.triggerEvent("hide_variation"))}else if(a.detail.focus||(r.triggerEvent("reset_image"),r.triggerEvent("hide_variation")),!a.detail.exclude){var g,m=_createForOfIteratorHelper(r.$productPrice);try{for(m.s();!(g=m.n()).done;){var y=g.value;n(y,y.getAttribute("data-default"))}}catch(t){m.e(t)}finally{m.f()}var w,b=_createForOfIteratorHelper(r.$productDescription);try{for(b.s();!(w=b.n()).done;){var A=w.value;n(A,A.getAttribute("data-default"))}}catch(t){b.e(t)}finally{b.f()}var _,S=_createForOfIteratorHelper(r.$productAvailability);try{for(S.s();!(_=S.n()).done;){var E=_.value;n(E,E.getAttribute("data-default"))}}catch(t){S.e(t)}finally{S.f()}var k,O=_createForOfIteratorHelper(r.$productSku);try{for(O.s();!(k=O.n()).done;){var j=k.value;n(j,j.getAttribute("data-default"))}}catch(t){O.e(t)}finally{O.f()}}r.triggerEvent("update_variation_values",{variations:e(l),currentSettings:e(o)});var L,P=_createForOfIteratorHelper(r.$productAddToCart);try{for(P.s();!(L=P.n()).done;){var I=L.value;I.disabled||(I.disabled=!r.id.value)}}catch(t){P.e(t)}finally{P.f()}var C,q=_createForOfIteratorHelper(r.$productChoose);try{for(q.s();!(C=q.n()).done;){var N=C.value;N.disabled||(N.disabled=!r.id.value)}}catch(t){q.e(t)}finally{q.f()}})),this.element.addEventListener("reset_image",(function(){return r.updateImage(!1)})),this.element.addEventListener("update_variation_values",(function(a){var n=a.detail.variation;if(!n||Object.keys(n).length<=0)return r;var i,o=!0,s=_createForOfIteratorHelper(r.$variationItem);try{var c=function(){var r,a=i.value,s=a.getAttribute("data-name"),c=a.querySelectorAll('[data-component~="wcpw-product-variations-item-value"]'),u=_createForOfIteratorHelper(c);try{for(u.s();!(r=u.n()).done;){var l=r.value;l.classList.remove("active"),l.disabled=!1}}catch(t){u.e(t)}finally{u.f()}for(var d in n)if(n.hasOwnProperty(d)){var p=e(n[d].attributes);for(var h in p)if(p.hasOwnProperty(h)&&h===s){var v=p[h];if(!v){var f=e(currentSettings),g=e(p);for(var m in delete g[h],delete f[h],g)g.hasOwnProperty(m)&&""===g[m]&&(delete g[m],delete f[m]);if(t(g,f)){var y,w=_createForOfIteratorHelper(c);try{for(w.s();!(y=w.n()).done;){y.value.classList.add("active")}}catch(t){w.e(t)}finally{w.f()}}}v=(v=(v=decodeURIComponent(v)).replace(/'/g,"\\'")).replace(/"/g,'\\"');var b,A=_createForOfIteratorHelper(c);try{for(A.s();!(b=A.n()).done;){var _=b.value;v?_.value===v&&_.classList.add("active"):_.classList.add("active")}}catch(t){A.e(t)}finally{A.f()}}}var S,E=_createForOfIteratorHelper(a.querySelectorAll('[data-component~="wcpw-product-variations-item-value"]:not(.active)'));try{for(E.s();!(S=E.n()).done;){S.value.disabled=!0}}catch(t){E.e(t)}finally{E.f()}if("SELECT"===a.tagName){var k=a.querySelector("option:checked");if(k.getAttribute("selected")||(o=!1),k.disabled){var O=a.querySelector("option:not(:disabled)");O&&setTimeout((function(){a.value=O.value}),0)}}else{var j=a.querySelector('[data-component~="wcpw-product-variations-item-value"]:checked');if(j.getAttribute("checked")||(o=!1),j.disabled){var L=a.querySelector('[data-component~="wcpw-product-variations-item-value"]:not(:disabled)');L&&setTimeout((function(){L.checked=!0}),0)}}};for(s.s();!(i=s.n()).done;)c()}catch(t){s.e(t)}finally{s.f()}var u,l=_createForOfIteratorHelper(r.$reset);try{for(l.s();!(u=l.n()).done;){u.value.setAttribute("hidden",String(o))}}catch(t){l.e(t)}finally{l.f()}return r.triggerEvent("woocommerce_update_variation_values"),r})),this.element.addEventListener("found_variation",(function(t){var e=!0,a=t.detail.variation;if(a.price_html){var i,o=_createForOfIteratorHelper(r.$productPrice);try{for(o.s();!(i=o.n()).done;){n(i.value,a.price_html)}}catch(t){o.e(t)}finally{o.f()}}r.$productQuantity&&a.min_qty&&r.$productQuantity.setAttribute("min",a.min_qty),r.$productQuantity&&a.max_qty&&r.$productQuantity.setAttribute("max",a.max_qty);var s,c=_createForOfIteratorHelper(r.$productDescription);try{for(c.s();!(s=c.n()).done;){var u=s.value;n(u,a.description||a.variation_description||u.getAttribute("data-default"))}}catch(t){c.e(t)}finally{c.f()}var l,d=_createForOfIteratorHelper(r.$productAvailability);try{for(d.s();!(l=d.n()).done;){var p=l.value;n(p,a.availability_html||p.getAttribute("data-default"))}}catch(t){d.e(t)}finally{d.f()}var h,v=_createForOfIteratorHelper(r.$productSku);try{for(v.s();!(h=v.n()).done;){var f=h.value;n(f,a.sku||f.getAttribute("data-default"))}}catch(t){v.e(t)}finally{v.f()}a.is_purchasable&&a.is_in_stock&&a.variation_is_visible||(e=!1);var g,m=_createForOfIteratorHelper(r.$productAddToCart);try{for(m.s();!(g=m.n()).done;){g.value.disabled=!e}}catch(t){m.e(t)}finally{m.f()}var y,w=_createForOfIteratorHelper(r.$productChoose);try{for(w.s();!(y=w.n()).done;){y.value.disabled=!e}}catch(t){w.e(t)}finally{w.f()}return r.updateImage(a)})),this.element.addEventListener("reset",(function(){var t,e=_createForOfIteratorHelper(r.$variationItemValue);try{for(e.s();!(t=e.n()).done;){var a=t.value,n="INPUT"===a.tagName;a.disabled=!1,a.checked=n?a.defaultChecked:a.defaultSelected}}catch(t){e.e(t)}finally{e.f()}var i,o=_createForOfIteratorHelper(r.$reset);try{for(o.s();!(i=o.n()).done;){i.value.setAttribute("hidden",!0)}}catch(t){o.e(t)}finally{o.f()}r.triggerEvent("check_variations")})),this.delegateEventListener("change.input.variationForm.wcpw",'[data-component~="wcpw-product-variations-item-input"]',(function(){a.id.value="",a.triggerEvent("woocommerce_variation_select_change"),a.triggerEvent("check_variations",{exclude:this.getAttribute("data-name"),focus:!0})})),this.delegateEventListener("click.reset.variationForm.wcpw",'[data-component~="wcpw-product-variations-reset"]',(function(t){return t.preventDefault(),r.triggerEvent("reset")})),this.triggerEvent("check_variations"),this.triggerEvent("wc_variation_form"),this}},{key:"triggerEvent",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.$element&&this.$element.trigger(t,Object.values(r)),this.element.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e({instance:this},r)})),this}},{key:"resetAttr",value:function(t,e){var r,a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var n=r.value;n.getAttribute("data-o_".concat(e))&&n.setAttribute(e,n.getAttribute("data-o_".concat(e)))}}catch(t){a.e(t)}finally{a.f()}return this}},{key:"setAttr",value:function(t,e,r){var a,n=_createForOfIteratorHelper(t);try{for(n.s();!(a=n.n()).done;){var i=a.value;i.getAttribute("data-o_".concat(e))&&i.setAttribute("data-o_".concat(e),i.getAttribute(e)?i.getAttribute(e):""),!1===r?i.removeAttribute(e):i.setAttribute(e,r)}}catch(t){n.e(t)}finally{n.f()}return this}},{key:"updateImage",value:function(t){return t&&t.image&&(t.image.src||t.image_src)?(this.setAttr(this.$productImage,"src",t.image_src||t.image.src),this.setAttr(this.$productImage,"srcset",t.image_srcset||t.image.srcset),this.setAttr(this.$productImage,"sizes",t.image_sizes||t.image.sizes),this.setAttr(this.$productImage,"title",t.image_title||t.image.title),this.setAttr(this.$productImage,"alt",t.image_alt||t.image.alt),this.setAttr(this.$productLink,"href",t.image_link||t.image.full_src)):(this.resetAttr(this.$productImage,"src"),this.resetAttr(this.$productImage,"srcset"),this.resetAttr(this.$productImage,"sizes"),this.resetAttr(this.$productImage,"alt"),this.resetAttr(this.$productLink,"href")),this}},{key:"findMatchingVariations",value:function(r,a){var n=[],i={};for(var o in r)if(r.hasOwnProperty(o)){var s=r[o];for(var c in a)if(a.hasOwnProperty(c)){var u=e(s.attributes),l=e(a);for(var d in delete u[c],delete l[c],u)u.hasOwnProperty(d)&&""===u[d]&&(delete u[d],delete l[d]);t(u,l)&&!i.hasOwnProperty(s.variation_id)&&(i[s.variation_id]=s.variation_id,n.push(s))}}return n}}])}(),c={windowNode:window,documentNode:document,$window:"undefined"!=typeof jQuery?jQuery(window):null,$document:"undefined"!=typeof jQuery?jQuery(document):null,$body:"undefined"!=typeof jQuery?jQuery(document.body):null,init:function(){if(void 0===o)return this.windowNode.console.error("WCPW class is not exist"),this;var t,e=_createForOfIteratorHelper(this.documentNode.querySelectorAll('[data-component~="wcpw"]'));try{for(e.s();!(t=e.n()).done;){var r=t.value;r.wcpw=new o(r,JSON.parse(r.getAttribute("data-options"))||{}),r.wcpw.init()}}catch(t){e.e(t)}finally{e.f()}return this},initVariationForm:function(t){if(void 0===s)return this.windowNode.console.error("WCPWVariationForm class is not exist"),this;var e,r=_createForOfIteratorHelper(t=t||this.documentNode.querySelectorAll('[data-component~="wcpw-product-variations"]'));try{for(r.s();!(e=r.n()).done;){var a=e.value;a.wcpwVariationForm=new s(a,JSON.parse(a.getAttribute("data-options"))||{}),a.wcpwVariationForm.init()}}catch(t){r.e(t)}finally{r.f()}return this},onInit:function(t){this.initVariationForm(t.element.querySelectorAll('[data-component~="wcpw-product-variations"]')),void 0!==this.windowNode.avadaLightBox&&void 0!==this.windowNode.avadaLightBox.activate_lightbox&&this.windowNode.avadaLightBox.activate_lightbox(jQuery(t.element))}};return void 0===c.documentNode.wcpw&&(c.documentNode.wcpw=c),c.documentNode.addEventListener("init.variationForm.wcpw",(function(){return c.initVariationForm()})),c.documentNode.addEventListener("init.wcpw",(function(){return c.init()})),c.documentNode.addEventListener("onInit.wcpw",(function(t){return c.onInit(t.detail.instance)})),c.documentNode.addEventListener("DOMContentLoaded",(function(){c.init()})),c.documentNode.addEventListener("launched.wcpw",(function(t){var e=t.detail.instance;c.onInit(e)})),c.documentNode.addEventListener("ajaxCompleted.wcpw",(function(t){var e=t.detail.instance,r=t.detail.response;if(t.detail.options,c.onInit(e),r instanceof Object&&r.hasError){var a=e.element.querySelector('[data-component~="wcpw-message"]');a&&!e.isScrolledIntoView(a)&&e.scrollToElement(a,e.options.scrollingUpGap),e.vibrate()}})),c.documentNode.addEventListener("submitError.wcpw",(function(t){var e=t.detail.instance;if(e&&!(e.productsWithError.length<=0)){var r=e.element.querySelector('[data-component~="wcpw-product"][data-id="'.concat(e.productsWithError[0].product_id,'"]')+'[data-step-id="'.concat(e.productsWithError[0].step_id,'"]'));r&&(e.isScrolledIntoView(r)||e.scrollToElement(r,e.options.scrollingUpGap),e.vibrate())}})),c}));